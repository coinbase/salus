module Cyclonedx
  class ReportNodeModules < Base
    TYPE = "npm".freeze
    UNLOCKED_DEPENDENCY_FILE = "package.json".freeze

    def initialize(scan_report)
      super(scan_report)
    end

    # Add scope attribute, if available:
    # https://cyclonedx.org/docs/1.3/json/#components_items_scope
    def build_component(dependency)
      super.merge({
          "external_references": dependency[:external_references],
          "scope": dependency[:scope]
                  })
    end
  end
end
